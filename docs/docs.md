# Doc

## 备忘

用户登录，返回一个 token，每一次请求需要对请求签名

md5(timestamp+请求方法+请求参数+请求体+token)

头部有个参数 token

api 获得 token

?k=xxx&timestamp&sign

sign = md5(timestamp+k+s)

--- 

用户登录，返回一个 jwt，每一次请求对请求签名，（请求方法，请求参数，请求体）

api，登录获得 jwt，请求同上，

注销功能，维护一个黑名单，key值有效期是1天


权限

web 登陆，获得token

鉴权： 根据token查redis，获得对应权限


## 流程

- 根据产品给的需求创建数据库结构
- 编写 api 文档
- 开始实现文档内编写的接口，遇到问题要及时修改文档
- 编写单元测试
- 进行整体测试


## 备忘

在实例化应用时添加admin

子账号只能看到自己的数据，只能操作自己的数据。

找回逻辑

从 i1 获得用户信息

第一个用户是部署应用时设置的用户

子账户 i1 里的，添加子账号查看子账号列表显示的是有dns示例使用权的用户列表

域名认证是否备案（？）

使用一组服务器

子账号单独的 api，apiscrent

一个实例一个库，可以添加多个实例，分库（和cs相同就行）

session 多个 redis

主账户唯一的权限就是可以管理子账户

a.com 有 10 条记录，转移到 b.com， 批量替换域名

解析生效速度

优先测试 dns 功能


## 数据库

info 数据库

id表 - 其他实例数据库（id，其他数据库的登陆信息，名称，管理员）

domain表 - domain具体属于哪一个实例数据库中

## 更新

管理后台看到所有的域，授权k的列表

创建一个域名

用授权k创建每一个域名返回操作这个域名的 k，s

操作记录使用的是每个域名的ks

后端可能会更换 dns 服务

一个实例，不能添加多个

域的ks永久有效

后台生成一个管理key

使用一套鉴权 ，带权限信息

